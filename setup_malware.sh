#!/bin/bash

# Setup script for extmorph malware directory

echo "ğŸ”§ extmorph - Malware Directory Setup"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# Check if malware directory exists
if [ ! -d "malware" ]; then
    echo "ğŸ“ Creating malware/ directory..."
    mkdir -p malware
else
    echo "âœ“ malware/ directory already exists"
fi

echo ""
echo "ğŸ“‹ Expected malware samples:"
echo ""
echo "Place your samples in malware/ with these names:"
echo "  â€¢ abyss-orig.exe     (SHA-256: 9243bdcbe30fbd430a841a623e9e1bcc894e4fdc136d46e702a94dad4b10dfdc)"
echo "  â€¢ babuk-orig.exe     (SHA-256: 9479a5dc61284ccc3f063ebb38da9f63400d8b25d8bca8d04b1832f02fac24de)"
echo "  â€¢ blackhunt2-orig.exe (SHA-256: 74df3452a6b9dcdba658af7a9cf5afb09cce51534f9bc63079827bf73075243b)"
echo "  â€¢ chaos52-orig.exe   (SHA-256: no validation)"
echo "  â€¢ trigona-orig.exe   (SHA-256: 85f4088286ac1eedc94ad9dc6465e9e4b89d1cde3012f9949450fcc9f2b60431)"
echo ""
echo "Alternative naming patterns:"
echo "  â€¢ <profile>.exe (e.g., abyss.exe)"
echo "  â€¢ <profile>_orig.exe (e.g., abyss_orig.exe)"
echo "  â€¢ <profile>.bin (e.g., abyss.bin)"
echo ""

# Check current files
if [ -d "malware" ]; then
    FILES=$(ls malware/*.{exe,bin} 2>/dev/null | wc -l)
    if [ "$FILES" -gt 0 ]; then
        echo "ğŸ“‚ Current files in malware/:"
        ls -lh malware/*.{exe,bin} 2>/dev/null | awk '{print "  â€¢ " $9 " (" $5 ")"}'
        echo ""
        echo "âœ“ Found $FILES malware sample(s)"
        
        # Verify SHA-256
        echo ""
        echo "ğŸ” Verifying SHA-256 hashes..."
        cd malware
        shopt -s nullglob
        for file in *.exe *.bin; do
            if [ -f "$file" ]; then
                hash=$(sha256sum "$file" | awk '{print $1}')
                echo "  â€¢ $file"
                echo "    $hash"
            fi
        done
        shopt -u nullglob
        cd ..
    else
        echo "âš ï¸  No malware samples found in malware/ directory"
        echo ""
        echo "To add samples:"
        echo "  cp /path/to/your/sample.exe malware/abyss-orig.exe"
    fi
fi

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â„¹ï¸  For more details, see: malware/README.md"
echo "âœ… Setup complete!"
